<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="mahmood sheikh" />
<meta name="generator" content="Org Mode" />
<title>learning math functions with neural networks</title><!-- lambda icon, frail attempt -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%221em%22 font-size=%22100%22 color=%22red%22>Î»</text></svg>">
<!-- not-so-awesome awesome font -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="stylesheet" href="/main.css">
<!-- for dark mode -->
<script src="darkmode.js"></script>
<script src="search.js"></script>
<script src="main.js"></script>
</head>
<body>
<div id="preamble" class="status">
<div class="navbar">
  <a href='/'>home</a>
  <a href='/blog.html'>blog</a>
  <a href='/search.html'>search</a>
  <a href='/about.html'>about</a>
  <div id="darkModeToggle" onclick="toggleDarkMode()">
    &#9680; <!-- Circle with left half black -->
  </div>
</div><h1 class="main-title">learning math functions with neural networks</h1>
</div>
<div id="content" class="content">
<p>
see <a href="https://www.youtube.com/watch?v=LTzNR9FVliU">polynomial regression quick demo</a><br />
</p>
<div id="outline-container-org418f1dc" class="outline-2">
<h2 id="org418f1dc">linear regression</h2>
<div class="outline-text-2" id="text-org418f1dc">
<p>
i could've used my code for <a href="/multivariate_linear_regression.html#1682012888">multivariate linear regression</a> but i wanna study how neural networks can do regression tasks<br />
if we were to try approximating a linear function using a simple <a href="/feedforward_neural_network.html#1683060983">multilayer perceptron</a> we would see that since most <a href="/activation_function.html#1683061700">activation function</a>s squash the values of the network into a small range like <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.2.2 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2723.352765pt%27 height=%2710.006208pt%27 viewBox=%27-.500002 -7.548551 23.352765 10.006208%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g4-150%27 d=%27m1.942715-.059776c0-.826899-.577833-.956413-.806974-.956413c-.249066 0-.577833 .14944-.577833 .577833c0 .398506 .358655 .498132 .617684 .498132c.069738 0 .119552-.009963 .14944-.019925c.039851-.009963 .069738-.019925 .089664-.019925c.069738 0 .139477 .049813 .139477 .139477c0 .18929-.159402 .637609-.816936 1.05604l.089664 .18929c.298879-.099626 1.115816-.757161 1.115816-1.464508z%27/%3E%0A%3Cpath id=%27g5-48%27 d=%27m2.608219-1.808219c0-1.123288-.49863-1.89589-1.216438-1.89589c-.30137 0-.531507 .093151-.734247 .284932c-.317808 .306849-.526027 .936986-.526027 1.578082c0 .59726 .180822 1.238356 .438356 1.545205c.20274 .241096 .482192 .372603 .8 .372603c.279452 0 .515068-.093151 .712329-.284932c.317808-.30137 .526027-.936986 .526027-1.6zm-.526027 .010959c0 1.145205-.241096 1.731507-.712329 1.731507s-.712329-.586301-.712329-1.726027c0-1.161644 .246575-1.769863 .717808-1.769863c.460274 0 .706849 .619178 .706849 1.764384z%27/%3E%0A%3Cpath id=%27g5-49%27 d=%27m2.158904 0v-.082192c-.432877-.005479-.520548-.060274-.520548-.323288v-3.287671l-.043836-.010959l-.986301 .49863v.076712c.065753-.027397 .126027-.049315 .147945-.060274c.09863-.038356 .191781-.060274 .246575-.060274c.115068 0 .164384 .082192 .164384 .257534v2.482192c0 .180822-.043836 .306849-.131507 .356164c-.082192 .049315-.158904 .065753-.389041 .071233v.082192h1.512329z%27/%3E%0A%3Cuse id=%27g2-187%27 xlink:href=%27%23g1-187%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cuse id=%27g2-188%27 xlink:href=%27%23g1-188%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cuse id=%27g7-48%27 xlink:href=%27%23g5-48%27 transform=%27scale%281.818182%29%27/%3E%0A%3Cuse id=%27g7-49%27 xlink:href=%27%23g5-49%27 transform=%27scale%281.818182%29%27/%3E%0A%3Cpath id=%27g1-187%27 d=%27m2.174546 1.221819h-.625455c-.24 0-.356364-.123636-.356364-.378182v-5.483639c0-.225455 .094545-.32 .327273-.32h.654546v-.181818h-1.534546v6.545457h1.534546v-.181818z%27/%3E%0A%3Cpath id=%27g1-188%27 d=%27m.247273 1.221819v.181818h1.534546v-6.545457h-1.534546v.181818h.625455c.24 0 .356364 .123636 .356364 .378182v5.483639c0 .225455-.101818 .32-.327273 .32h-.654546z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page12%27%3E%0A%3Cg fill=%27currentColor%27%3E%0A%3Cuse x=%27.597749%27 y=%270%27 xlink:href=%27%23g2-187%27/%3E%0A%3Cuse x=%274.214177%27 y=%270%27 xlink:href=%27%23g7-48%27/%3E%0A%3Cuse x=%279.195497%27 y=%270%27 xlink:href=%27%23g4-150%27/%3E%0A%3Cuse x=%2713.456131%27 y=%270%27 xlink:href=%27%23g7-49%27/%3E%0A%3Cuse x=%2718.437451%27 y=%270%27 xlink:href=%27%23g2-188%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\([0,1]\)" style="height: 0.9843em; vertical-align: -0.2418em; display: inline-block" class="org-latex org-latex-inline" /> in case of the <a href="/sigmoid.html#1683061938">sigmoid</a>, it would be hard to regress to <a href="/function.html#1699680865">function</a>s whose codomain is different that that of the activation functions, so we probably want to use a special activation function, or even easier, drop activation functions altogether, this way the neural network would basically be doing linear regression<br />
lets begin by trying to learn a linear function, for that we need to be able to generate random linear functions, perhaps with some noise, so we write a simple function for that:<br />
</p>
<div class="org-src-container" data-language="lisp">
<pre class="src src-lisp" id="src-generate-points-along-function">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">generate-points-along-function</span> (fn noise-variance n <span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> (range 1000))
  <span style="font-style: italic;">"generate n points along a function with some random noise. fn takes x and outputs y"</span>
  (<span style="font-weight: bold;">let</span> ((points))
    (<span style="font-weight: bold;">dotimes</span> (i n)
      (<span style="font-weight: bold;">let*</span> ((x (* (random 1.0) range))
             (y (funcall fn x))
             (noise (* (random 1.0) noise-variance)))
        (push (cons x (+ y noise)) points)))
    points))
</pre>
</div>
<p>
exampe usage:<br />
</p>
<div class="org-src-container" data-language="lisp">
<pre class="src src-lisp">(generate-points-along-function (<span style="font-weight: bold;">lambda</span> (x) (+ (* x 4) 1)) 100 8)
</pre>
</div>

<pre class="example">
((323.82587971045893 . 1336.929248169381) (761.7768437987273 . 3124.6563720878803) (601.0078553135228 . 2405.7767912649115) (996.7744381640551 . 4010.1473993246946) (491.45378817988416 . 2049.610870629911) (962.7972354395187 . 3941.6661421752256) (722.4208034750477 . 2891.885256833865) (321.9555567443162 . 1350.870370348188))
</pre>


<p>
i also wanted a cheap way to visualize this for now (i havent yet implemented native visualization) so i just use tikz:<br />
</p>
<div class="org-src-container" data-language="lisp">
<pre class="src src-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">tikz-scatter-plot</span> (points)
  <span style="font-style: italic;">"turn points into a latex tikz/pgf block"</span>
  (format t <span style="font-style: italic;">"\\begin{tikzpicture}\\begin{axis}[xlabel=x, ylabel=y]</span>
<span style="font-style: italic;">  \\addplot[scatter, only marks,</span>
<span style="font-style: italic;">  error bars/.cd, y dir=both, x dir=both, y explicit, x explicit, error bar style={color=mapped color}]</span>
<span style="font-style: italic;">  table[x=x,y=y] {</span>
<span style="font-style: italic;">  x y~%"</span>)
  (<span style="font-weight: bold;">loop</span> for point in points do
    (format t <span style="font-style: italic;">"~F ~F~%"</span> (float (car point)) (float (cdr point))))
  (format t <span style="font-style: italic;">"};\\end{axis}\\end{tikzpicture}~%"</span>))
</pre>
</div>
<p>
example usage:<br />
</p>
<div class="org-src-container" data-language="lisp">
<pre class="src src-lisp">(tikz-scatter-plot (generate-points-along-function (<span style="font-weight: bold;">lambda</span> (x) (+ (* x 4) 1)) 700 50))
</pre>
</div>


<div class="equation-container">
<span class="equation">
<img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.2.2 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27368.203724pt%27 height=%27188.862353pt%27 viewBox=%27-.500002 -188.362352 368.203724 188.862353%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g5-89%27 d=%27m4.772105 0v-.14944c-.308842 0-.508095-.159402-.816936-.597758l-1.275218-1.952677l.826899-1.195517c.18929-.268991 .488169-.428394 .806974-.438356v-.14944h-1.574097v.14944c.298879 .019925 .398506 .079701 .398506 .219178c0 .119552-.119552 .33873-.368618 .647572c-.049813 .059776-.169365 .239103-.298879 .438356l-.139477-.199253c-.278954-.418431-.458281-.757161-.458281-.886675c0-.139477 .129514-.209215 .428394-.219178v-.14944h-2.062267v.14944h.089664c.298879 0 .458281 .129514 .767123 .597758l.936488 1.43462l-1.135741 1.643836c-.298879 .408468-.398506 .478207-.727273 .508095v.14944h1.444583v-.14944c-.278954 0-.398506-.049813-.398506-.179328c0-.059776 .069738-.209215 .199253-.408468l.787049-1.225405l.9066 1.39477c.039851 .059776 .059776 .119552 .059776 .179328c0 .179328-.069738 .219178-.398506 .239103v.14944h2.002491z%27/%3E%0A%3Cpath id=%27g5-90%27 d=%27m4.732254-4.333748v-.14944h-1.344956v.14944c.318804 0 .478207 .089664 .478207 .249066c0 .039851-.009963 .099626-.039851 .169365l-.966376 2.749689l-1.145704-2.520548c-.059776-.139477-.099626-.268991-.099626-.37858c0-.179328 .14944-.249066 .577833-.268991v-.14944h-2.052304v.139477c.259029 .039851 .428394 .14944 .508095 .318804l1.643836 3.466999c.069738 .169365 .109589 .288917 .109589 .368618c0 .14944-.229141 .777086-.398506 1.075965c-.139477 .259029-.358655 .448319-.498132 .448319c-.059776 0-.14944-.019925-.249066-.069738c-.18929-.069738-.358655-.109589-.52802-.109589c-.229141 0-.428394 .199253-.428394 .438356c0 .328767 .318804 .577833 .737235 .577833c.667497 0 1.145704-.557908 1.683686-1.992528l1.534247-4.064757c.129514-.318804 .239103-.418431 .478207-.448319z%27/%3E%0A%3Cpath id=%27g2-150%27 d=%27m1.942715-.059776c0-.826899-.577833-.956413-.806974-.956413c-.249066 0-.577833 .14944-.577833 .577833c0 .398506 .358655 .498132 .617684 .498132c.069738 0 .119552-.009963 .14944-.019925c.039851-.009963 .069738-.019925 .089664-.019925c.069738 0 .139477 .049813 .139477 .139477c0 .18929-.159402 .637609-.816936 1.05604l.089664 .18929c.298879-.099626 1.115816-.757161 1.115816-1.464508z%27/%3E%0A%3Cuse id=%27g4-48%27 xlink:href=%27%23g3-48%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cuse id=%27g4-49%27 xlink:href=%27%23g3-49%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cuse id=%27g4-50%27 xlink:href=%27%23g3-50%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cuse id=%27g4-51%27 xlink:href=%27%23g3-51%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cuse id=%27g4-52%27 xlink:href=%27%23g3-52%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cuse id=%27g4-54%27 xlink:href=%27%23g3-54%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cuse id=%27g4-56%27 xlink:href=%27%23g3-56%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cpath id=%27g3-48%27 d=%27m3.46182-2.400001c0-1.49091-.661818-2.516365-1.614546-2.516365c-.4 0-.705455 .123636-.974546 .378182c-.421818 .407273-.698182 1.243637-.698182 2.094546c0 .792728 .24 1.643637 .581818 2.05091c.269091 .32 .64 .494546 1.061819 .494546c.370909 0 .683637-.123636 .945455-.378182c.421818-.4 .698182-1.243637 .698182-2.123637zm-.698182 .014545c0 1.520001-.32 2.298183-.945455 2.298183s-.945455-.778182-.945455-2.29091c0-1.541819 .327273-2.349092 .952728-2.349092c.610909 0 .938182 .821819 .938182 2.341819z%27/%3E%0A%3Cpath id=%27g3-49%27 d=%27m2.865456 0v-.109091c-.574546-.007273-.690909-.08-.690909-.429091v-4.363638l-.058182-.014545l-1.309091 .661818v.101818c.087273-.036364 .167273-.065455 .196364-.08c.130909-.050909 .254546-.08 .327273-.08c.152727 0 .218182 .109091 .218182 .341818v3.294547c0 .24-.058182 .407273-.174546 .472727c-.109091 .065455-.210909 .087273-.516364 .094545v.109091h2.007274z%27/%3E%0A%3Cpath id=%27g3-50%27 d=%27m3.454547-.996364l-.094545-.036364c-.269091 .414546-.363637 .48-.690909 .48h-1.738183l1.221819-1.280001c.647273-.676364 .930909-1.229091 .930909-1.796364c0-.727273-.589091-1.287273-1.345455-1.287273c-.4 0-.778182 .16-1.047273 .450909c-.232727 .247273-.341818 .48-.465455 .996364l.152727 .036364c.290909-.712728 .552728-.945455 1.054546-.945455c.610909 0 1.025455 .414546 1.025455 1.025455c0 .567273-.334546 1.243637-.945455 1.89091l-1.294546 1.374546v.087273h2.836365l.4-.996364z%27/%3E%0A%3Cpath id=%27g3-51%27 d=%27m3.141819-1.592728c0-.370909-.116364-.712728-.327273-.938182c-.145455-.16-.283636-.247273-.603637-.385455c.501818-.341818 .683637-.610909 .683637-1.003637c0-.589091-.465455-.996364-1.134546-.996364c-.363637 0-.683637 .123636-.945455 .356364c-.218182 .196364-.327273 .385455-.487273 .821819l.109091 .029091c.298182-.530909 .625455-.770909 1.083637-.770909c.472727 0 .8 .32 .8 .778182c0 .261818-.109091 .523637-.290909 .705455c-.218182 .218182-.421818 .327273-.916364 .501818v.094545c.429091 0 .596364 .014545 .770909 .08c.450909 .16 .734546 .574546 .734546 1.076364c0 .610909-.414546 1.083637-.952728 1.083637c-.196364 0-.341818-.050909-.610909-.225455c-.218182-.130909-.341818-.181818-.465455-.181818c-.167273 0-.276364 .101818-.276364 .254546c0 .254546 .312727 .414546 .821819 .414546c.56 0 1.134546-.189091 1.476364-.487273s.530909-.72 .530909-1.207273z%27/%3E%0A%3Cpath id=%27g3-52%27 d=%27m3.432729-1.214546v-.465455h-.741818v-3.236365h-.32l-2.283637 3.236365v.465455h2.043637v1.214546h.56v-1.214546h.741818zm-1.309091-.465455h-1.745455l1.745455-2.494546v2.494546z%27/%3E%0A%3Cpath id=%27g3-54%27 d=%27m3.403638-1.592728c0-.930909-.530909-1.520001-1.367273-1.520001c-.32 0-.472727 .050909-.930909 .327273c.196364-1.098182 1.01091-1.883637 2.152728-2.072728l-.014545-.116364c-.829091 .072727-1.25091 .210909-1.781819 .581818c-.785455 .56-1.214546 1.389091-1.214546 2.363637c0 .632728 .196364 1.272728 .509091 1.636364c.276364 .32 .669091 .494546 1.12 .494546c.901819 0 1.527273-.690909 1.527273-1.694546zm-.654546 .247273c0 .8-.283636 1.243637-.792728 1.243637c-.64 0-1.032728-.683637-1.032728-1.81091c0-.370909 .058182-.574546 .203636-.683637c.152727-.116364 .378182-.181818 .632728-.181818c.625455 0 .989091 .523637 .989091 1.432728z%27/%3E%0A%3Cpath id=%27g3-56%27 d=%27m3.236365-1.127273c0-.56-.247273-.916364-1.127273-1.57091c.72-.385455 .974546-.690909 .974546-1.185455c0-.596364-.523637-1.032728-1.25091-1.032728c-.792728 0-1.381819 .487273-1.381819 1.149091c0 .472727 .138182 .683637 .901819 1.352728c-.785455 .596364-.945455 .821819-.945455 1.316364c0 .705455 .574546 1.200001 1.396364 1.200001c.872728 0 1.432728-.48 1.432728-1.229091zm-.552728 .225455c0 .472727-.327273 .8-.8 .8c-.552728 0-.923637-.421818-.923637-1.054546c0-.465455 .16-.770909 .581818-1.112728l.436364 .32c.530909 .378182 .705455 .64 .705455 1.047273zm-.101818-2.989092c0 .414546-.203636 .741818-.618182 1.018182c-.036364 .021818-.036364 .021818-.065455 .043636c-.647273-.421818-.909091-.756364-.909091-1.163637c0-.421818 .327273-.72 .785455-.72c.494546 0 .807273 .32 .807273 .821819z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page1%27%3E%0A%3Cg fill=%27none%27 stroke-miterlimit=%2710%27%3E%0A%3Cpath d=%27m46.4531-26.2656v-4.25391m35.3555 4.25391v-4.25391m35.3516 4.25391v-4.25391m35.3554 4.25391v-4.25391m35.3515 4.25391v-4.25391m35.356 4.25391v-4.25391m-176.77-157.14489v4.25m35.3555-4.25v4.25m35.3516-4.25v4.25m35.3554-4.25v4.25m35.3515-4.25v4.25m35.356-4.25v4.25%27 stroke=%27%23808080%27 stroke-width=%27.19925%27/%3E%0A%3Cpath d=%27m41.5156-56.1172h4.2539m-4.2539-33.1718h4.2539m-4.2539-33.168h4.2539m-4.2539-33.1714h4.2539m190.0236 99.5112h-4.25m4.25-33.1718h-4.25m4.25-33.168h-4.25m4.25-33.1714h-4.25%27 stroke=%27%23808080%27 stroke-width=%27.19925%27/%3E%0A%3Cpath d=%27m41.5156-26.2656v-161.3988h194.2775v161.3988h-194.2775z%27 stroke=%27%23000%27 stroke-width=%27.3985%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%28-55.2626 49.9629%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%28-24.8903 49.9629%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-50%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27109.187562%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%2810.4631 49.9629%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-52%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27109.187562%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%2845.8171 50.0974%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-54%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27109.187562%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%2881.1711 49.9629%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-56%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27109.187562%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%28112.7341 49.9629%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-49%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g2-150%27/%3E%0A%3Cuse x=%27106.806476%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27111.787796%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27116.769117%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%28-83.754 12.5288%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-49%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g2-150%27/%3E%0A%3Cuse x=%27106.806476%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27111.787796%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27116.769117%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%28-83.754 -20.6419%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-50%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g2-150%27/%3E%0A%3Cuse x=%27106.806476%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27111.787796%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27116.769117%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%28-83.754 -53.8128%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-51%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g2-150%27/%3E%0A%3Cuse x=%27106.806476%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27111.787796%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27116.769117%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27translate%28-83.754 -86.9838%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g4-52%27/%3E%0A%3Cuse x=%27104.206242%27 y=%27-65.985206%27 xlink:href=%27%23g2-150%27/%3E%0A%3Cuse x=%27106.806476%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27111.787796%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3Cuse x=%27116.769117%27 y=%27-65.985206%27 xlink:href=%27%23g4-48%27/%3E%0A%3C/g%3E%0A%3Cpath d=%27m138.4883-104.8437c0-1.1016-.8945-1.9961-1.9922-1.9961c-1.1016 0-1.9961 .8945-1.9961 1.9961c0 1.0976 .8945 1.9922 1.9961 1.9922c1.0977 0 1.9922-.8946 1.9922-1.9922z%27 fill=%27%23ffc500%27/%3E%0A%3Cpath d=%27m138.4883-104.8437c0-1.1016-.8945-1.9961-1.9922-1.9961c-1.1016 0-1.9961 .8945-1.9961 1.9961c0 1.0976 .8945 1.9922 1.9961 1.9922c1.0977 0 1.9922-.8946 1.9922-1.9922z%27 stroke=%27%23cc9e00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m122.4648-98.082c0-1.1016-.8945-1.9922-1.9921-1.9922c-1.1016 0-1.9922 .8906-1.9922 1.9922c0 1.1015 .8906 1.9922 1.9922 1.9922c1.0976 0 1.9921-.8907 1.9921-1.9922z%27 fill=%27%23ffd900%27/%3E%0A%3Cpath d=%27m122.4648-98.082c0-1.1016-.8945-1.9922-1.9921-1.9922c-1.1016 0-1.9922 .8906-1.9922 1.9922c0 1.1015 .8906 1.9922 1.9922 1.9922c1.0976 0 1.9921-.8907 1.9921-1.9922z%27 stroke=%27%23ccad00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m100.1719-75.457c0-1.1016-.8906-1.9922-1.9922-1.9922s-1.9922 .8906-1.9922 1.9922c0 1.1015 .8906 1.9922 1.9922 1.9922s1.9922-.8907 1.9922-1.9922z%27 fill=%27%23cbcb34%27/%3E%0A%3Cpath d=%27m100.1719-75.457c0-1.1016-.8906-1.9922-1.9922-1.9922s-1.9922 .8906-1.9922 1.9922c0 1.1015 .8906 1.9922 1.9922 1.9922s1.9922-.8907 1.9922-1.9922z%27 stroke=%27%23a3a329%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m205.9761-163.8634c0-1.101-.89-1.992-1.992-1.992c-1.101 0-1.992 .891-1.992 1.992c0 1.098 .891 1.992 1.992 1.992c1.102 0 1.992-.894 1.992-1.992z%27 fill=%27%23ff1d00%27/%3E%0A%3Cpath d=%27m205.9761-163.8634c0-1.101-.89-1.992-1.992-1.992c-1.101 0-1.992 .891-1.992 1.992c0 1.098 .891 1.992 1.992 1.992c1.102 0 1.992-.894 1.992-1.992z%27 stroke=%27%23cc1800%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m221.5941-174.2144c0-1.102-.891-1.993-1.993-1.993c-1.097 0-1.992 .891-1.992 1.993c0 1.101 .895 1.992 1.992 1.992c1.102 0 1.993-.891 1.993-1.992z%27 fill=%27%23f00%27/%3E%0A%3Cpath d=%27m221.5941-174.2144c0-1.102-.891-1.993-1.993-1.993c-1.097 0-1.992 .891-1.992 1.993c0 1.101 .895 1.992 1.992 1.992c1.102 0 1.993-.891 1.993-1.992z%27 stroke=%27%23c00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m114.5117-91.5508c0-1.0976-.8906-1.9922-1.9922-1.9922c-1.1015 0-1.9922 .8946-1.9922 1.9922c0 1.1016 .8907 1.9922 1.9922 1.9922c1.1016 0 1.9922-.8906 1.9922-1.9922z%27 fill=%27%23ffeb00%27/%3E%0A%3Cpath d=%27m114.5117-91.5508c0-1.0976-.8906-1.9922-1.9922-1.9922c-1.1015 0-1.9922 .8946-1.9922 1.9922c0 1.1016 .8907 1.9922 1.9922 1.9922c1.1016 0 1.9922-.8906 1.9922-1.9922z%27 stroke=%27%23ccbc00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m152.8086-103.0078c0-1.1016-.8906-1.9922-1.9922-1.9922s-1.9922 .8906-1.9922 1.9922s.8906 1.9922 1.9922 1.9922s1.9922-.8906 1.9922-1.9922z%27 fill=%27%23ffcb00%27/%3E%0A%3Cpath d=%27m152.8086-103.0078c0-1.1016-.8906-1.9922-1.9922-1.9922s-1.9922 .8906-1.9922 1.9922s.8906 1.9922 1.9922 1.9922s1.9922-.8906 1.9922-1.9922z%27 stroke=%27%23cca200%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m142.3164-95.8164c0-1.1016-.8945-1.9922-1.9922-1.9922c-1.1015 0-1.9922 .8906-1.9922 1.9922s.8907 1.9922 1.9922 1.9922c1.0977 0 1.9922-.8906 1.9922-1.9922z%27 fill=%27%23ffdf00%27/%3E%0A%3Cpath d=%27m142.3164-95.8164c0-1.1016-.8945-1.9922-1.9922-1.9922c-1.1015 0-1.9922 .8906-1.9922 1.9922s.8907 1.9922 1.9922 1.9922c1.0977 0 1.9922-.8906 1.9922-1.9922z%27 stroke=%27%23ccb200%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m183.3401-133.9922c0-1.1015-.891-1.9922-1.992-1.9922c-1.102 0-1.993 .8907-1.993 1.9922c0 1.0977 .891 1.9922 1.993 1.9922c1.101 0 1.992-.8945 1.992-1.9922z%27 fill=%27%23ff7200%27/%3E%0A%3Cpath d=%27m183.3401-133.9922c0-1.1015-.891-1.9922-1.992-1.9922c-1.102 0-1.993 .8907-1.993 1.9922c0 1.0977 .891 1.9922 1.993 1.9922c1.101 0 1.992-.8945 1.992-1.9922z%27 stroke=%27%23cc5c00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m203.5591-145.2534c0-1.102-.895-1.993-1.993-1.993c-1.101 0-1.992 .891-1.992 1.993c0 1.101 .891 1.992 1.992 1.992c1.098 0 1.993-.891 1.993-1.992z%27 fill=%27%23ff5200%27/%3E%0A%3Cpath d=%27m203.5591-145.2534c0-1.102-.895-1.993-1.993-1.993c-1.101 0-1.992 .891-1.992 1.993c0 1.101 .891 1.992 1.992 1.992c1.098 0 1.993-.891 1.993-1.992z%27 stroke=%27%23cc4200%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m60.625-39.718731c0-1.097659-.89453-1.992189-1.992187-1.992189c-1.101563 0-1.996093 .89453-1.996093 1.992189c0 1.101561 .89453 1.992191 1.996093 1.992191c1.097657 0 1.992187-.89063 1.992187-1.992191z%27 fill=%27%2300f%27/%3E%0A%3Cpath d=%27m60.625-39.718731c0-1.097659-.89453-1.992189-1.992187-1.992189c-1.101563 0-1.996093 .89453-1.996093 1.992189c0 1.101561 .89453 1.992191 1.996093 1.992191c1.097657 0 1.992187-.89063 1.992187-1.992191z%27 stroke=%27%2300c%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m207.6171-165.2344c0-1.102-.894-1.992-1.992-1.992c-1.102 0-1.996 .89-1.996 1.992s.894 1.992 1.996 1.992c1.098 0 1.992-.89 1.992-1.992z%27 fill=%27%23ff1a00%27/%3E%0A%3Cpath d=%27m207.6171-165.2344c0-1.102-.894-1.992-1.992-1.992c-1.102 0-1.996 .89-1.996 1.992s.894 1.992 1.996 1.992c1.098 0 1.992-.89 1.992-1.992z%27 stroke=%27%23cc1400%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m160.5511-119.375c0-1.1015-.891-1.9922-1.993-1.9922c-1.0972 0-1.9917 .8907-1.9917 1.9922c0 1.1016 .8945 1.9922 1.9917 1.9922c1.102 0 1.993-.8906 1.993-1.9922z%27 fill=%27%23ff9c00%27/%3E%0A%3Cpath d=%27m160.5511-119.375c0-1.1015-.891-1.9922-1.993-1.9922c-1.0972 0-1.9917 .8907-1.9917 1.9922c0 1.1016 .8945 1.9922 1.9917 1.9922c1.102 0 1.993-.8906 1.993-1.9922z%27 stroke=%27%23cc7d00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m117.3242-80.4922c0-1.1015-.8906-1.9922-1.9922-1.9922c-1.1015 0-1.9922 .8907-1.9922 1.9922c0 1.0977 .8907 1.9922 1.9922 1.9922c1.1016 0 1.9922-.8945 1.9922-1.9922z%27 fill=%27%23e8e817%27/%3E%0A%3Cpath d=%27m117.3242-80.4922c0-1.1015-.8906-1.9922-1.9922-1.9922c-1.1015 0-1.9922 .8907-1.9922 1.9922c0 1.0977 .8907 1.9922 1.9922 1.9922c1.1016 0 1.9922-.8945 1.9922-1.9922z%27 stroke=%27%23baba12%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m162.8011-123.7617c0-1.1016-.895-1.9922-1.993-1.9922c-1.101 0-1.992 .8906-1.992 1.9922s.891 1.9922 1.992 1.9922c1.098 0 1.993-.8906 1.993-1.9922z%27 fill=%27%23ff8f00%27/%3E%0A%3Cpath d=%27m162.8011-123.7617c0-1.1016-.895-1.9922-1.993-1.9922c-1.101 0-1.992 .8906-1.992 1.9922s.891 1.9922 1.992 1.9922c1.098 0 1.993-.8906 1.993-1.9922z%27 stroke=%27%23cc7300%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m82.7852-71.6992c0-1.1016-.8907-1.9922-1.9922-1.9922c-1.1016 0-1.9922 .8906-1.9922 1.9922s.8906 1.9922 1.9922 1.9922c1.1015 0 1.9922-.8906 1.9922-1.9922z%27 fill=%27%23b6b649%27/%3E%0A%3Cpath d=%27m82.7852-71.6992c0-1.1016-.8907-1.9922-1.9922-1.9922c-1.1016 0-1.9922 .8906-1.9922 1.9922s.8906 1.9922 1.9922 1.9922c1.1015 0 1.9922-.8906 1.9922-1.9922z%27 stroke=%27%2392923a%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m64.76953-42.15623c0-1.10156-.89453-1.99219-1.99219-1.99219c-1.10156 0-1.99218 .89063-1.99218 1.99219s.89062 1.992186 1.99218 1.992186c1.09766 0 1.99219-.890626 1.99219-1.992186z%27 fill=%27%230e0ef1%27/%3E%0A%3Cpath d=%27m64.76953-42.15623c0-1.10156-.89453-1.99219-1.99219-1.99219c-1.10156 0-1.99218 .89063-1.99218 1.99219s.89062 1.992186 1.99218 1.992186c1.09766 0 1.99219-.890626 1.99219-1.992186z%27 stroke=%27%230b0bc1%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m146.3477-113.7617c0-1.0977-.8907-1.9922-1.9922-1.9922c-1.1016 0-1.9922 .8945-1.9922 1.9922c0 1.1016 .8906 1.9961 1.9922 1.9961c1.1015 0 1.9922-.8945 1.9922-1.9961z%27 fill=%27%23ffac00%27/%3E%0A%3Cpath d=%27m146.3477-113.7617c0-1.0977-.8907-1.9922-1.9922-1.9922c-1.1016 0-1.9922 .8945-1.9922 1.9922c0 1.1016 .8906 1.9961 1.9922 1.9961c1.1015 0 1.9922-.8945 1.9922-1.9961z%27 stroke=%27%23cc8a00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m59.69922-46.12498c0-1.10156-.89063-1.99219-1.992189-1.99219c-1.101561 0-1.992191 .89063-1.992191 1.99219c0 1.09765 .89063 1.99219 1.992191 1.99219c1.101559 0 1.992189-.89454 1.992189-1.99219z%27 fill=%27%232424db%27/%3E%0A%3Cpath d=%27m59.69922-46.12498c0-1.10156-.89063-1.99219-1.992189-1.99219c-1.101561 0-1.992191 .89063-1.992191 1.99219c0 1.09765 .89063 1.99219 1.992191 1.99219c1.101559 0 1.992189-.89454 1.992189-1.99219z%27 stroke=%27%231d1daf%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m121.2891-91.4609c0-1.1016-.8907-1.9922-1.9922-1.9922c-1.0977 0-1.9922 .8906-1.9922 1.9922c0 1.0976 .8945 1.9922 1.9922 1.9922c1.1015 0 1.9922-.8946 1.9922-1.9922z%27 fill=%27%23ffeb00%27/%3E%0A%3Cpath d=%27m121.2891-91.4609c0-1.1016-.8907-1.9922-1.9922-1.9922c-1.0977 0-1.9922 .8906-1.9922 1.9922c0 1.0976 .8945 1.9922 1.9922 1.9922c1.1015 0 1.9922-.8946 1.9922-1.9922z%27 stroke=%27%23ccbc00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m108.9648-82.4258c0-1.1015-.8906-1.9922-1.9921-1.9922c-1.0977 0-1.9922 .8907-1.9922 1.9922c0 1.1016 .8945 1.9922 1.9922 1.9922c1.1015 0 1.9921-.8906 1.9921-1.9922z%27 fill=%27%23f3f30c%27/%3E%0A%3Cpath d=%27m108.9648-82.4258c0-1.1015-.8906-1.9922-1.9921-1.9922c-1.0977 0-1.9922 .8907-1.9922 1.9922c0 1.1016 .8945 1.9922 1.9922 1.9922c1.1015 0 1.9921-.8906 1.9921-1.9922z%27 stroke=%27%23c2c20a%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m103.4141-72.3125c0-1.0976-.8946-1.9922-1.9922-1.9922c-1.1016 0-1.9961 .8946-1.9961 1.9922c0 1.1016 .8945 1.9922 1.9961 1.9922c1.0976 0 1.9922-.8906 1.9922-1.9922z%27 fill=%27%23b9b946%27/%3E%0A%3Cpath d=%27m103.4141-72.3125c0-1.0976-.8946-1.9922-1.9922-1.9922c-1.1016 0-1.9961 .8946-1.9961 1.9922c0 1.1016 .8945 1.9922 1.9961 1.9922c1.0976 0 1.9922-.8906 1.9922-1.9922z%27 stroke=%27%23949438%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m187.1131-146.6644c0-1.101-.894-1.992-1.992-1.992c-1.102 0-1.992 .891-1.992 1.992c0 1.102 .89 1.993 1.992 1.993c1.098 0 1.992-.891 1.992-1.993z%27 fill=%27%23ff4e00%27/%3E%0A%3Cpath d=%27m187.1131-146.6644c0-1.101-.894-1.992-1.992-1.992c-1.102 0-1.992 .891-1.992 1.992c0 1.102 .89 1.993 1.992 1.993c1.098 0 1.992-.891 1.992-1.993z%27 stroke=%27%23cc3f00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m134.4023-109.5469c0-1.0976-.8906-1.9921-1.9921-1.9921c-1.1016 0-1.9922 .8945-1.9922 1.9921c0 1.1016 .8906 1.9961 1.9922 1.9961c1.1015 0 1.9921-.8945 1.9921-1.9961z%27 fill=%27%23ffb800%27/%3E%0A%3Cpath d=%27m134.4023-109.5469c0-1.0976-.8906-1.9921-1.9921-1.9921c-1.1016 0-1.9922 .8945-1.9922 1.9921c0 1.1016 .8906 1.9961 1.9922 1.9961c1.1015 0 1.9921-.8945 1.9921-1.9961z%27 stroke=%27%23cc9300%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m139.5664-102.5508c0-1.0976-.8906-1.9921-1.9922-1.9921c-1.1015 0-1.9922 .8945-1.9922 1.9921c0 1.1016 .8907 1.9922 1.9922 1.9922c1.1016 0 1.9922-.8906 1.9922-1.9922z%27 fill=%27%23fc0%27/%3E%0A%3Cpath d=%27m139.5664-102.5508c0-1.0976-.8906-1.9921-1.9922-1.9921c-1.1015 0-1.9922 .8945-1.9922 1.9921c0 1.1016 .8907 1.9922 1.9922 1.9922c1.1016 0 1.9922-.8906 1.9922-1.9922z%27 stroke=%27%23cca300%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m111.6367-88.9258c0-1.1015-.8945-1.9922-1.9961-1.9922c-1.0976 0-1.9922 .8907-1.9922 1.9922c0 1.1016 .8946 1.9922 1.9922 1.9922c1.1016 0 1.9961-.8906 1.9961-1.9922z%27 fill=%27%23fff300%27/%3E%0A%3Cpath d=%27m111.6367-88.9258c0-1.1015-.8945-1.9922-1.9961-1.9922c-1.0976 0-1.9922 .8907-1.9922 1.9922c0 1.1016 .8946 1.9922 1.9922 1.9922c1.1016 0 1.9961-.8906 1.9961-1.9922z%27 stroke=%27%23ccc200%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m201.8791-146.5664c0-1.102-.895-1.996-1.992-1.996c-1.102 0-1.993 .894-1.993 1.996c0 1.098 .891 1.992 1.993 1.992c1.097 0 1.992-.894 1.992-1.992z%27 fill=%27%23ff4f00%27/%3E%0A%3Cpath d=%27m201.8791-146.5664c0-1.102-.895-1.996-1.992-1.996c-1.102 0-1.993 .894-1.993 1.996c0 1.098 .891 1.992 1.993 1.992c1.097 0 1.992-.894 1.992-1.992z%27 stroke=%27%23cc3f00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m171.8751-125.4687c0-1.0977-.891-1.9922-1.992-1.9922c-1.102 0-1.992 .8945-1.992 1.9922c0 1.1015 .89 1.9922 1.992 1.9922c1.101 0 1.992-.8907 1.992-1.9922z%27 fill=%27%23ff8b00%27/%3E%0A%3Cpath d=%27m171.8751-125.4687c0-1.0977-.891-1.9922-1.992-1.9922c-1.102 0-1.992 .8945-1.992 1.9922c0 1.1015 .89 1.9922 1.992 1.9922c1.101 0 1.992-.8907 1.992-1.9922z%27 stroke=%27%23cc6f00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m61.07031-49.23436c0-1.10154-.89062-1.99214-1.99218-1.99214c-1.101567 0-1.992192 .8906-1.992192 1.99214c0 1.10157 .890625 1.99219 1.992192 1.99219c1.10156 0 1.99218-.89062 1.99218-1.99219z%27 fill=%27%233636c9%27/%3E%0A%3Cpath d=%27m61.07031-49.23436c0-1.10154-.89062-1.99214-1.99218-1.99214c-1.101567 0-1.992192 .8906-1.992192 1.99214c0 1.10157 .890625 1.99219 1.992192 1.99219c1.10156 0 1.99218-.89062 1.99218-1.99219z%27 stroke=%27%232b2ba1%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m103.5039-78.1445c0-1.0977-.8906-1.9922-1.9922-1.9922c-1.0976 0-1.9922 .8945-1.9922 1.9922c0 1.1015 .8946 1.9961 1.9922 1.9961c1.1016 0 1.9922-.8946 1.9922-1.9961z%27 fill=%27%23dbdb24%27/%3E%0A%3Cpath d=%27m103.5039-78.1445c0-1.0977-.8906-1.9922-1.9922-1.9922c-1.0976 0-1.9922 .8945-1.9922 1.9922c0 1.1015 .8946 1.9961 1.9922 1.9961c1.1016 0 1.9922-.8946 1.9922-1.9961z%27 stroke=%27%23afaf1d%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m210.8941-145.0824c0-1.101-.894-1.992-1.992-1.992c-1.101 0-1.996 .891-1.996 1.992c0 1.102 .895 1.993 1.996 1.993c1.098 0 1.992-.891 1.992-1.993z%27 fill=%27%23ff5300%27/%3E%0A%3Cpath d=%27m210.8941-145.0824c0-1.101-.894-1.992-1.992-1.992c-1.101 0-1.996 .891-1.996 1.992c0 1.102 .895 1.993 1.996 1.993c1.098 0 1.992-.891 1.992-1.993z%27 stroke=%27%23cc4200%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m151.75-118.0937c0-1.1016-.8906-1.9922-1.9922-1.9922c-1.0976 0-1.9922 .8906-1.9922 1.9922c0 1.0976 .8946 1.9922 1.9922 1.9922c1.1016 0 1.9922-.8946 1.9922-1.9922z%27 fill=%27%23ffa000%27/%3E%0A%3Cpath d=%27m151.75-118.0937c0-1.1016-.8906-1.9922-1.9922-1.9922c-1.0976 0-1.9922 .8906-1.9922 1.9922c0 1.0976 .8946 1.9922 1.9922 1.9922c1.1016 0 1.9922-.8946 1.9922-1.9922z%27 stroke=%27%23cc8000%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m195.4221-139.7934c0-1.097-.891-1.992-1.992-1.992c-1.098 0-1.993 .895-1.993 1.992c0 1.102 .895 1.9965 1.993 1.9965c1.101 0 1.992-.8945 1.992-1.9965z%27 fill=%27%23ff6200%27/%3E%0A%3Cpath d=%27m195.4221-139.7934c0-1.097-.891-1.992-1.992-1.992c-1.098 0-1.993 .895-1.993 1.992c0 1.102 .895 1.9965 1.993 1.9965c1.101 0 1.992-.8945 1.992-1.9965z%27 stroke=%27%23cc4e00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m197.5551-140.1214c0-1.101-.895-1.992-1.993-1.992c-1.101 0-1.992 .891-1.992 1.992c0 1.098 .891 1.9925 1.992 1.9925c1.098 0 1.993-.8945 1.993-1.9925z%27 fill=%27%23ff6100%27/%3E%0A%3Cpath d=%27m197.5551-140.1214c0-1.101-.895-1.992-1.993-1.992c-1.101 0-1.992 .891-1.992 1.992c0 1.098 .891 1.9925 1.992 1.9925c1.098 0 1.993-.8945 1.993-1.9925z%27 stroke=%27%23cc4e00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m98.6094-60.8515c0-1.1016-.8946-1.9922-1.9961-1.9922c-1.0977 0-1.9922 .8906-1.9922 1.9922c0 1.0976 .8945 1.9921 1.9922 1.9921c1.1015 0 1.9961-.8945 1.9961-1.9921z%27 fill=%27%23787887%27/%3E%0A%3Cpath d=%27m98.6094-60.8515c0-1.1016-.8946-1.9922-1.9961-1.9922c-1.0977 0-1.9922 .8906-1.9922 1.9922c0 1.0976 .8945 1.9921 1.9922 1.9921c1.1015 0 1.9961-.8945 1.9961-1.9921z%27 stroke=%27%2360606c%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m154.6055-116.457c0-1.1016-.8907-1.9922-1.9922-1.9922c-1.1016 0-1.9922 .8906-1.9922 1.9922s.8906 1.9922 1.9922 1.9922c1.1015 0 1.9922-.8906 1.9922-1.9922z%27 fill=%27%23ffa400%27/%3E%0A%3Cpath d=%27m154.6055-116.457c0-1.1016-.8907-1.9922-1.9922-1.9922c-1.1016 0-1.9922 .8906-1.9922 1.9922s.8906 1.9922 1.9922 1.9922c1.1015 0 1.9922-.8906 1.9922-1.9922z%27 stroke=%27%23cc8300%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m220.0431-165.6254c0-1.101-.891-1.992-1.992-1.992c-1.102 0-1.992 .891-1.992 1.992c0 1.102 .89 1.993 1.992 1.993c1.101 0 1.992-.891 1.992-1.993z%27 fill=%27%23ff1800%27/%3E%0A%3Cpath d=%27m220.0431-165.6254c0-1.101-.891-1.992-1.992-1.992c-1.102 0-1.992 .891-1.992 1.992c0 1.102 .89 1.993 1.992 1.993c1.101 0 1.992-.891 1.992-1.993z%27 stroke=%27%23cc1400%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m210.0701-149.3984c0-1.098-.89-1.992-1.992-1.992s-1.992 .894-1.992 1.992c0 1.102 .89 1.992 1.992 1.992s1.992-.89 1.992-1.992z%27 fill=%27%23ff4700%27/%3E%0A%3Cpath d=%27m210.0701-149.3984c0-1.098-.89-1.992-1.992-1.992s-1.992 .894-1.992 1.992c0 1.102 .89 1.992 1.992 1.992s1.992-.89 1.992-1.992z%27 stroke=%27%23cc3800%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m214.8161-170.1994c0-1.101-.89-1.992-1.992-1.992c-1.101 0-1.992 .891-1.992 1.992c0 1.098 .891 1.992 1.992 1.992c1.102 0 1.992-.894 1.992-1.992z%27 fill=%27%23ff0b00%27/%3E%0A%3Cpath d=%27m214.8161-170.1994c0-1.101-.89-1.992-1.992-1.992c-1.101 0-1.992 .891-1.992 1.992c0 1.098 .891 1.992 1.992 1.992c1.102 0 1.992-.894 1.992-1.992z%27 stroke=%27%23cc0900%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m104.168-75.293c0-1.0976-.8907-1.9921-1.9922-1.9921c-1.1016 0-1.9922 .8945-1.9922 1.9921c0 1.1016 .8906 1.9922 1.9922 1.9922c1.1015 0 1.9922-.8906 1.9922-1.9922z%27 fill=%27%23caca35%27/%3E%0A%3Cpath d=%27m104.168-75.293c0-1.0976-.8907-1.9921-1.9922-1.9921c-1.1016 0-1.9922 .8945-1.9922 1.9921c0 1.1016 .8906 1.9922 1.9922 1.9922c1.1015 0 1.9922-.8906 1.9922-1.9922z%27 stroke=%27%23a2a22a%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m212.8011-168.0624c0-1.102-.891-1.992-1.992-1.992c-1.102 0-1.993 .89-1.993 1.992c0 1.098 .891 1.992 1.993 1.992c1.101 0 1.992-.894 1.992-1.992z%27 fill=%27%23ff1200%27/%3E%0A%3Cpath d=%27m212.8011-168.0624c0-1.102-.891-1.992-1.992-1.992c-1.102 0-1.993 .89-1.993 1.992c0 1.098 .891 1.992 1.993 1.992c1.101 0 1.992-.894 1.992-1.992z%27 stroke=%27%23cc0e00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m210.1911-167.4414c0-1.102-.89-1.992-1.992-1.992c-1.101 0-1.992 .89-1.992 1.992s.891 1.992 1.992 1.992c1.102 0 1.992-.89 1.992-1.992z%27 fill=%27%23ff1300%27/%3E%0A%3Cpath d=%27m210.1911-167.4414c0-1.102-.89-1.992-1.992-1.992c-1.101 0-1.992 .89-1.992 1.992s.891 1.992 1.992 1.992c1.102 0 1.992-.89 1.992-1.992z%27 stroke=%27%23cc0f00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m65.01953-58.3086c0-1.1015-.89062-1.9922-1.99219-1.9922c-1.10156 0-1.99218 .8907-1.99218 1.9922c0 1.1016 .89062 1.9922 1.99218 1.9922c1.10157 0 1.99219-.8906 1.99219-1.9922z%27 fill=%27%236a6a95%27/%3E%0A%3Cpath d=%27m65.01953-58.3086c0-1.1015-.89062-1.9922-1.99219-1.9922c-1.10156 0-1.99218 .8907-1.99218 1.9922c0 1.1016 .89062 1.9922 1.99218 1.9922c1.10157 0 1.99219-.8906 1.99219-1.9922z%27 stroke=%27%23557%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m146.9063-105.6328c0-1.0976-.8946-1.9922-1.9922-1.9922c-1.1016 0-1.9961 .8946-1.9961 1.9922c0 1.1016 .8945 1.9961 1.9961 1.9961c1.0976 0 1.9922-.8945 1.9922-1.9961z%27 fill=%27%23ffc300%27/%3E%0A%3Cpath d=%27m146.9063-105.6328c0-1.0976-.8946-1.9922-1.9922-1.9922c-1.1016 0-1.9961 .8946-1.9961 1.9922c0 1.1016 .8945 1.9961 1.9961 1.9961c1.0976 0 1.9922-.8945 1.9922-1.9961z%27 stroke=%27%23cc9c00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m82.9297-51.0547c0-1.1015-.8906-1.9922-1.9922-1.9922s-1.9922 .8907-1.9922 1.9922c0 1.0977 .8906 1.99222 1.9922 1.99222s1.9922-.89452 1.9922-1.99222z%27 fill=%27%234040bf%27/%3E%0A%3Cpath d=%27m82.9297-51.0547c0-1.1015-.8906-1.9922-1.9922-1.9922s-1.9922 .8907-1.9922 1.9922c0 1.0977 .8906 1.99222 1.9922 1.99222s1.9922-.89452 1.9922-1.99222z%27 stroke=%27%23343498%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m95.2383-72.414c0-1.1016-.8906-1.9922-1.9922-1.9922s-1.9922 .8906-1.9922 1.9922c0 1.1015 .8906 1.9921 1.9922 1.9921s1.9922-.8906 1.9922-1.9921z%27 fill=%27%23baba45%27/%3E%0A%3Cpath d=%27m95.2383-72.414c0-1.1016-.8906-1.9922-1.9922-1.9922s-1.9922 .8906-1.9922 1.9922c0 1.1015 .8906 1.9921 1.9922 1.9921s1.9922-.8906 1.9922-1.9921z%27 stroke=%27%23959537%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m194.5901-142.9374c0-1.102-.895-1.996-1.992-1.996c-1.102 0-1.993 .894-1.993 1.996c0 1.098 .891 1.992 1.993 1.992c1.097 0 1.992-.894 1.992-1.992z%27 fill=%27%23ff5900%27/%3E%0A%3Cpath d=%27m194.5901-142.9374c0-1.102-.895-1.996-1.992-1.996c-1.102 0-1.993 .894-1.993 1.996c0 1.098 .891 1.992 1.993 1.992c1.097 0 1.992-.894 1.992-1.992z%27 stroke=%27%23cc4700%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m93.3398-78.4492c0-1.1016-.8906-1.9922-1.9921-1.9922c-1.1016 0-1.9922 .8906-1.9922 1.9922c0 1.0977 .8906 1.9922 1.9922 1.9922c1.1015 0 1.9921-.8945 1.9921-1.9922z%27 fill=%27%23dcdc23%27/%3E%0A%3Cpath d=%27m93.3398-78.4492c0-1.1016-.8906-1.9922-1.9921-1.9922c-1.1016 0-1.9922 .8906-1.9922 1.9922c0 1.0977 .8906 1.9922 1.9922 1.9922c1.1015 0 1.9921-.8945 1.9921-1.9922z%27 stroke=%27%23b0b01c%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m191.9061-146.2184c0-1.102-.89-1.993-1.992-1.993c-1.098 0-1.992 .891-1.992 1.993c0 1.097 .894 1.992 1.992 1.992c1.102 0 1.992-.895 1.992-1.992z%27 fill=%27%23ff5000%27/%3E%0A%3Cpath d=%27m191.9061-146.2184c0-1.102-.89-1.993-1.992-1.993c-1.098 0-1.992 .891-1.992 1.993c0 1.097 .894 1.992 1.992 1.992c1.102 0 1.992-.895 1.992-1.992z%27 stroke=%27%23cc4000%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cpath d=%27m159.7111-112.789c0-1.0977-.891-1.9922-1.992-1.9922c-1.1019 0-1.9925 .8945-1.9925 1.9922c0 1.1015 .8906 1.9961 1.9925 1.9961c1.101 0 1.992-.8946 1.992-1.9961z%27 fill=%27%23ffaf00%27/%3E%0A%3Cpath d=%27m159.7111-112.789c0-1.0977-.891-1.9922-1.992-1.9922c-1.1019 0-1.9925 .8945-1.9925 1.9922c0 1.1015 .8906 1.9961 1.9925 1.9961c1.101 0 1.992-.8946 1.992-1.9961z%27 stroke=%27%23cc8c00%27 fill=%27none%27 stroke-width=%27.3985%27 stroke-miterlimit=%2710%27/%3E%0A%3Cg transform=%27translate%2836.9391 62.66547%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g5-89%27/%3E%0A%3C/g%3E%0A%3Cg transform=%27matrix%280 -1 1 0 73.78774 -5.2501%29%27%3E%0A%3Cuse x=%2799.224922%27 y=%27-65.985206%27 xlink:href=%27%23g5-90%27/%3E%0A%3C/g%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\begin{tikzpicture}\begin{axis}[xlabel=x, ylabel=y]
  \addplot[scatter, only marks,
  error bars/.cd, y dir=both, x dir=both, y explicit, x explicit, error bar style={color=mapped color}]
  table[x=x,y=y] {
  x y
509.37332 2469.0366
418.72955 2265.1428
292.62592 1583.0686
891.1723 4248.2856
979.5288 4560.3
373.7452 2068.2043
590.3997 2413.6165
531.0335 2196.837
763.1168 3347.76
877.4886 3687.2097
68.89212 505.6162
900.44403 4289.6006
634.1989 2907.0457
389.65714 1734.8844
646.9155 3039.3267
194.26346 1469.7496
92.342735 579.1305
553.8459 2737.7837
63.665627 698.8331
412.0921 2065.5603
342.37338 1793.1719
310.95575 1488.2341
784.454 3729.7388
486.26483 2610.7214
515.48016 2399.8267
357.47028 1989.115
867.98645 3726.849
698.25854 3090.7283
71.423294 792.50476
311.48135 1664.0254
918.98474 3682.0667
584.4146 2868.4614
831.47095 3522.5525
843.5225 3532.5403
283.77258 1142.7871
600.5609 2819.085
970.7513 4301.3535
914.3338 3812.1416
941.1855 4439.2954
315.22607 1578.0789
929.77704 4374.881
915.01355 4356.1
93.76299 1066.0858
556.99634 2492.7202
195.08075 847.4318
264.7184 1491.3075
826.7517 3617.4543
253.9736 1673.3092
811.58374 3716.347
629.4473 2708.457
};\end{axis}\end{tikzpicture}
" style="height: 18.5779em; vertical-align: -0.0492em; display: inline-block" class="org-latex org-latex-inline" />
</span>
</div>

<p>
lets do regression now, for this problem, we are trying to approximate a function <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.2.2 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2744.587375pt%27 height=%279.792015pt%27 viewBox=%27-.500002 -7.224784 44.587375 9.792015%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-33%27 d=%27m9.58406-2.570361l-1.952677-2.032379l-.308842 .328767l1.185554 1.43462h-7.890411v.557908h7.890411l-1.185554 1.43462l.308842 .328767l1.952677-2.052304z%27/%3E%0A%3Cpath id=%27g0-82%27 d=%27m6.585305 .029888v-.468244c-.368618-.019925-.617684-.109589-.86675-.408468l-1.823163-2.241594c.9066-.209215 1.62391-.697385 1.62391-1.703611c0-1.444583-1.39477-1.823163-2.580324-1.823163h-2.799502v.458281c.637609 .049813 .816936 .029888 .816936 .727273v4.154421c0 .737235-.069738 .797011-.816936 .836862v.468244h2.948941v-.468244c-.637609-.029888-.856787-.009963-.856787-.727273v-1.753425l.318804-.009963l2.281445 2.958904h1.753425zm-.607721-.298879h-1.006227l-2.281445-2.958904l-.757161 .029888v2.032379c0 .358655 .019925 .737235 .398506 .896638h-1.474471c.358655-.14944 .388543-.518057 .388543-.86675v-4.293898c0-.358655-.009963-.747198-.398506-.896638h2.092154c1.006227 0 2.291407 .278954 2.291407 1.534247c0 1.105853-.966376 1.344956-1.863014 1.514321l2.132005 2.620174c.129514 .159402 .288917 .298879 .478207 .388543zm-1.504359-4.542964c0-1.09589-.836862-1.454545-1.793275-1.454545c-.37858 0-.747198 .009963-.747198 .488169v2.510585c1.115816-.009963 2.540473-.089664 2.540473-1.544209zm-.288917 0c0 1.115816-1.085928 1.235367-1.952677 1.255293v-2.221669c0-.179328 .129514-.199253 .268991-.199253c.826899 0 1.683686 .139477 1.683686 1.165629z%27/%3E%0A%3Cuse id=%27g4-58%27 xlink:href=%27%23g3-58%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cpath id=%27g3-58%27 d=%27m1.396364-2.923638c0-.225455-.189091-.414546-.407273-.414546s-.4 .189091-.4 .414546c0 .210909 .181818 .392727 .392727 .392727c.225455 0 .414546-.181818 .414546-.392727zm0 2.61091c0-.225455-.189091-.414546-.407273-.414546s-.4 .189091-.4 .414546c0 .210909 .181818 .392727 .392727 .392727c.225455 0 .414546-.181818 .414546-.392727z%27/%3E%0A%3Cpath id=%27g2-53%27 d=%27m4.224159-6.107098c0-.368618-.368618-.647572-.856787-.647572c-.478207 0-.856787 .209215-1.215442 .647572c-.308842 .398506-.518057 .86675-.816936 1.843088h-.916563l-.069738 .318804h.896638l-.876712 4.184309c-.229141 1.075965-.547945 1.613948-.966376 1.613948c-.119552 0-.199253-.069738-.199253-.159402c0-.039851 .009963-.059776 .039851-.109589c.039851-.059776 .049813-.099626 .049813-.159402c0-.209215-.179328-.37858-.388543-.37858s-.368618 .179328-.368618 .408468c0 .348692 .33873 .607721 .787049 .607721c.886675 0 1.574097-.976339 1.992528-2.819427l.71731-3.188045h1.085928l.059776-.318804h-1.075965c.288917-1.574097 .657534-2.271482 1.215442-2.271482c.139477 0 .219178 .049813 .219178 .129514c0 0-.009963 .049813-.039851 .089664c-.049813 .079701-.059776 .129514-.059776 .209215c0 .239103 .14944 .398506 .368618 .398506c.229141 0 .418431-.179328 .418431-.398506z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page2%27%3E%0A%3Cuse x=%271.73349%27 y=%270%27 xlink:href=%27%23g2-53%27/%3E%0A%3Cuse x=%279.023869%27 y=%270%27 xlink:href=%27%23g4-58%27/%3E%0A%3Cuse x=%2714.560814%27 y=%270%27 xlink:href=%27%23g0-82%27/%3E%0A%3Cuse x=%2723.973226%27 y=%270%27 xlink:href=%27%23g1-33%27/%3E%0A%3Cuse x=%2736.942304%27 y=%270%27 xlink:href=%27%23g0-82%27/%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(f: \mathbb{R} \to \mathbb{R}\)" style="height: 0.9632em; vertical-align: -0.2525em; display: inline-block" class="org-latex org-latex-inline" />, so it only makes sense for the network to have 1 input and 1 output, we use a single hidden <a href="/convolutional_neural_network.html#1684594232">dense layer</a> for the simplicity and compactness of the model, although there would be no point in having more than a single node in the hidden layer because in any case we'd be doing <a href="/univariate_linear_regression.html#1678739604">univariate linear regression</a><br />
</p>
<div class="org-src-container" data-language="lisp">
<pre class="src src-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">regression-test-1</span> ()
  (<span style="font-weight: bold;">let</span> ((nw (make-network
             <span style="font-weight: bold;">:layers</span> (list (make-dense-layer <span style="font-weight: bold;">:num-units</span> 1 <span style="font-weight: bold;">:prev-layer-num-units</span> 1
                                             <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">the identity function is basically a cheap wway to train with no activation functions</span>
                                             <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">derivative of identity function is 1, f(x)=x =&gt; f'(x)=1</span>
                                             <span style="font-weight: bold;">:activation-function</span> #'identity
                                             <span style="font-weight: bold;">:activation-function-derivative</span> (<span style="font-weight: bold;">lambda</span> (val) 1))
                           (make-dense-layer <span style="font-weight: bold;">:num-units</span> 1 <span style="font-weight: bold;">:prev-layer-num-units</span> 1
                                             <span style="font-weight: bold;">:activation-function</span> #'identity
                                             <span style="font-weight: bold;">:activation-function-derivative</span> (<span style="font-weight: bold;">lambda</span> (val) 1)))
             <span style="font-weight: bold;">:learning-rate</span> 0.0001))
        (data (mapcar (<span style="font-weight: bold;">lambda</span> (mycons) (cons (make-array 1 <span style="font-weight: bold;">:initial-element</span> (car mycons))
                                             (make-array 1 <span style="font-weight: bold;">:initial-element</span> (cdr mycons))))
                      (generate-points-along-function (<span style="font-weight: bold;">lambda</span> (x) (+ (* x 5) 3)) 5 1000 1))) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">1000 samples</span>
        (epochs 10000))
    (<span style="font-weight: bold;">loop</span> repeat epochs do
      (network-train nw data)
      (print (network-test nw data)))))
</pre>
</div>
<p>
when running <code>regression-test-1</code>, the loss drops quiet quickly and then almost stabilizes at some number&#x2013;we're approximating a linear function with noise after all, so slight inaccuracy is expected<br />
</p>
</div>
</div>
<div id="outline-container-org4d99b77" class="outline-2">
<h2 id="org4d99b77">polynomial regression</h2>
<div class="outline-text-2" id="text-org4d99b77">
<p>
the difference in codomains is not the only reason we need to consider different activation functions, a neural network is a function that is a composition of its activation functions, a linear function can be a composition of other linear functions, but it makes less sense for a linear function to be a composition of sigmoids<br />
each parameter that the network learns is a coefficient that is multiplied by the activation of a neuron, the activation of a neuron itself is a function, determined by the activation function of that neuron, so if we wanted to approximate a polynomial, we need different coefficients for different exponential degrees, e.g. <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.2.2 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%27112.997737pt%27 height=%2711.1217pt%27 viewBox=%27-.500002 -9.025511 112.997737 11.1217%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g1-184%27 d=%27m2.480697-2.849315h-2.181818v.657534h2.181818v2.191781h.657534v-2.191781h2.181818v-.657534h-2.181818v-2.191781h-.657534v2.191781z%27/%3E%0A%3Cpath id=%27g3-48%27 d=%27m3.46182-2.400001c0-1.49091-.661818-2.516365-1.614546-2.516365c-.4 0-.705455 .123636-.974546 .378182c-.421818 .407273-.698182 1.243637-.698182 2.094546c0 .792728 .24 1.643637 .581818 2.05091c.269091 .32 .64 .494546 1.061819 .494546c.370909 0 .683637-.123636 .945455-.378182c.421818-.4 .698182-1.243637 .698182-2.123637zm-.698182 .014545c0 1.520001-.32 2.298183-.945455 2.298183s-.945455-.778182-.945455-2.29091c0-1.541819 .327273-2.349092 .952728-2.349092c.610909 0 .938182 .821819 .938182 2.341819z%27/%3E%0A%3Cpath id=%27g3-49%27 d=%27m2.865456 0v-.109091c-.574546-.007273-.690909-.08-.690909-.429091v-4.363638l-.058182-.014545l-1.309091 .661818v.101818c.087273-.036364 .167273-.065455 .196364-.08c.130909-.050909 .254546-.08 .327273-.08c.152727 0 .218182 .109091 .218182 .341818v3.294547c0 .24-.058182 .407273-.174546 .472727c-.109091 .065455-.210909 .087273-.516364 .094545v.109091h2.007274z%27/%3E%0A%3Cpath id=%27g3-50%27 d=%27m3.454547-.996364l-.094545-.036364c-.269091 .414546-.363637 .48-.690909 .48h-1.738183l1.221819-1.280001c.647273-.676364 .930909-1.229091 .930909-1.796364c0-.727273-.589091-1.287273-1.345455-1.287273c-.4 0-.778182 .16-1.047273 .450909c-.232727 .247273-.341818 .48-.465455 .996364l.152727 .036364c.290909-.712728 .552728-.945455 1.054546-.945455c.610909 0 1.025455 .414546 1.025455 1.025455c0 .567273-.334546 1.243637-.945455 1.89091l-1.294546 1.374546v.087273h2.836365l.4-.996364z%27/%3E%0A%3Cpath id=%27g3-51%27 d=%27m3.141819-1.592728c0-.370909-.116364-.712728-.327273-.938182c-.145455-.16-.283636-.247273-.603637-.385455c.501818-.341818 .683637-.610909 .683637-1.003637c0-.589091-.465455-.996364-1.134546-.996364c-.363637 0-.683637 .123636-.945455 .356364c-.218182 .196364-.327273 .385455-.487273 .821819l.109091 .029091c.298182-.530909 .625455-.770909 1.083637-.770909c.472727 0 .8 .32 .8 .778182c0 .261818-.109091 .523637-.290909 .705455c-.218182 .218182-.421818 .327273-.916364 .501818v.094545c.429091 0 .596364 .014545 .770909 .08c.450909 .16 .734546 .574546 .734546 1.076364c0 .610909-.414546 1.083637-.952728 1.083637c-.196364 0-.341818-.050909-.610909-.225455c-.218182-.130909-.341818-.181818-.465455-.181818c-.167273 0-.276364 .101818-.276364 .254546c0 .254546 .312727 .414546 .821819 .414546c.56 0 1.134546-.189091 1.476364-.487273s.530909-.72 .530909-1.207273z%27/%3E%0A%3Cpath id=%27g2-70%27 d=%27m6.455791-3.875467c0-.298879-.219178-.518057-.518057-.518057c-.239103 0-.388543 .129514-.388543 .328767c0 .139477 .049813 .219178 .209215 .368618s.219178 .249066 .219178 .368618c0 .428394-.33873 .956413-1.643836 2.590286l-.318804-3.506849c0-.109589-.019925-.139477-.079701-.139477c-.049813 0-.079701 .019925-.129514 .099626l-1.912827 3.028643c-.039851-.876712-.179328-2.082192-.318804-2.799502c-.059776-.318804-.079701-.33873-.18929-.33873c-.508095 .119552-1.225405 .239103-1.225405 .239103v.129514h.288917c.288917 0 .358655 .059776 .438356 .418431c.109589 .478207 .239103 1.633873 .278954 2.440847l.039851 .876712c.019925 .388543 .039851 .468244 .129514 .468244c.109589 0 1.155666-1.92279 1.155666-1.92279l.876712-1.404732l.328767 3.028643c.019925 .268991 .039851 .298879 .109589 .298879c.089664 0 .18929-.099626 .448319-.428394l.089664-.109589c1.384807-1.663761 2.11208-2.879203 2.11208-3.516812z%27/%3E%0A%3Cpath id=%27g2-71%27 d=%27m4.144458-1.026152l-.139477-.079701c-.079701 .099626-.129514 .14944-.219178 .268991c-.229141 .298879-.33873 .398506-.468244 .398506c-.139477 0-.229141-.129514-.298879-.408468c-.019925-.089664-.029888-.139477-.039851-.159402c-.239103-.936488-.358655-1.474471-.358655-1.62391c.438356-.767123 .797011-1.205479 .976339-1.205479c.059776 0 .14944 .029888 .239103 .079701c.119552 .069738 .18929 .089664 .278954 .089664c.199253 0 .33873-.14944 .33873-.358655c0-.219178-.169365-.368618-.408468-.368618c-.438356 0-.806974 .358655-1.504359 1.424658l-.109589-.547945c-.139477-.67746-.249066-.876712-.518057-.876712c-.229141 0-.547945 .079701-1.165629 .288917l-.109589 .039851l.039851 .14944l.169365-.039851c.18929-.049813 .308842-.069738 .388543-.069738c.249066 0 .308842 .089664 .448319 .687422l.288917 1.225405l-.816936 1.165629c-.209215 .298879-.398506 .478207-.508095 .478207c-.059776 0-.159402-.029888-.259029-.089664c-.129514-.069738-.229141-.099626-.318804-.099626c-.199253 0-.33873 .14944-.33873 .348692c0 .259029 .18929 .418431 .498132 .418431s.428394-.089664 .926526-.687422l.896638-1.175592l.298879 1.195517c.129514 .518057 .259029 .667497 .577833 .667497c.37858 0 .637609-.239103 1.215442-1.135741z%27/%3E%0A%3Cpath id=%27g2-149%27 d=%27m1.803238-.428394c0-.308842-.259029-.56787-.557908-.56787s-.547945 .249066-.547945 .56787c0 .37858 .33873 .537983 .547945 .537983s.557908-.169365 .557908-.537983z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page3%27%3E%0A%3Cuse x=%27.129504%27 y=%270%27 xlink:href=%27%23g2-70%27/%3E%0A%3Cuse x=%277.222914%27 y=%271.494381%27 xlink:href=%27%23g3-48%27/%3E%0A%3Cuse x=%2713.57127%27 y=%270%27 xlink:href=%27%23g1-184%27/%3E%0A%3Cuse x=%2721.53357%27 y=%270%27 xlink:href=%27%23g2-70%27/%3E%0A%3Cuse x=%2728.62698%27 y=%271.494381%27 xlink:href=%27%23g3-49%27/%3E%0A%3Cuse x=%2732.76147%27 y=%270%27 xlink:href=%27%23g2-71%27/%3E%0A%3Cuse x=%2739.881908%27 y=%270%27 xlink:href=%27%23g1-184%27/%3E%0A%3Cuse x=%2747.844209%27 y=%270%27 xlink:href=%27%23g2-70%27/%3E%0A%3Cuse x=%2754.937619%27 y=%271.494381%27 xlink:href=%27%23g3-50%27/%3E%0A%3Cuse x=%2759.072108%27 y=%270%27 xlink:href=%27%23g2-71%27/%3E%0A%3Cuse x=%2763.978681%27 y=%27-3.616428%27 xlink:href=%27%23g3-50%27/%3E%0A%3Cuse x=%2770.327037%27 y=%270%27 xlink:href=%27%23g1-184%27/%3E%0A%3Cuse x=%2778.289337%27 y=%270%27 xlink:href=%27%23g2-70%27/%3E%0A%3Cuse x=%2785.382747%27 y=%271.494381%27 xlink:href=%27%23g3-51%27/%3E%0A%3Cuse x=%2789.517237%27 y=%270%27 xlink:href=%27%23g2-71%27/%3E%0A%3Cuse x=%2794.42381%27 y=%27-3.616428%27 xlink:href=%27%23g3-51%27/%3E%0A%3Cuse x=%27100.378089%27 y=%270%27 xlink:href=%27%23g2-149%27/%3E%0A%3Cuse x=%27104.857902%27 y=%270%27 xlink:href=%27%23g2-149%27/%3E%0A%3Cuse x=%27109.337716%27 y=%270%27 xlink:href=%27%23g2-149%27/%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(w_0 + w_1x + w_2x^2 + w_3x^3 \dots\)" style="height: 1.0940em; vertical-align: -0.2062em; display: inline-block" class="org-latex org-latex-inline" />, here the weights (including the bias <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.2.2 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2712.357407pt%27 height=%276.910001pt%27 viewBox=%27-.500002 -4.813812 12.357407 6.910001%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g3-48%27 d=%27m3.46182-2.400001c0-1.49091-.661818-2.516365-1.614546-2.516365c-.4 0-.705455 .123636-.974546 .378182c-.421818 .407273-.698182 1.243637-.698182 2.094546c0 .792728 .24 1.643637 .581818 2.05091c.269091 .32 .64 .494546 1.061819 .494546c.370909 0 .683637-.123636 .945455-.378182c.421818-.4 .698182-1.243637 .698182-2.123637zm-.698182 .014545c0 1.520001-.32 2.298183-.945455 2.298183s-.945455-.778182-.945455-2.29091c0-1.541819 .327273-2.349092 .952728-2.349092c.610909 0 .938182 .821819 .938182 2.341819z%27/%3E%0A%3Cpath id=%27g2-70%27 d=%27m6.455791-3.875467c0-.298879-.219178-.518057-.518057-.518057c-.239103 0-.388543 .129514-.388543 .328767c0 .139477 .049813 .219178 .209215 .368618s.219178 .249066 .219178 .368618c0 .428394-.33873 .956413-1.643836 2.590286l-.318804-3.506849c0-.109589-.019925-.139477-.079701-.139477c-.049813 0-.079701 .019925-.129514 .099626l-1.912827 3.028643c-.039851-.876712-.179328-2.082192-.318804-2.799502c-.059776-.318804-.079701-.33873-.18929-.33873c-.508095 .119552-1.225405 .239103-1.225405 .239103v.129514h.288917c.288917 0 .358655 .059776 .438356 .418431c.109589 .478207 .239103 1.633873 .278954 2.440847l.039851 .876712c.019925 .388543 .039851 .468244 .129514 .468244c.109589 0 1.155666-1.92279 1.155666-1.92279l.876712-1.404732l.328767 3.028643c.019925 .268991 .039851 .298879 .109589 .298879c.089664 0 .18929-.099626 .448319-.428394l.089664-.109589c1.384807-1.663761 2.11208-2.879203 2.11208-3.516812z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page4%27%3E%0A%3Cuse x=%27.129504%27 y=%270%27 xlink:href=%27%23g2-70%27/%3E%0A%3Cuse x=%277.222914%27 y=%271.494381%27 xlink:href=%27%23g3-48%27/%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\(w_0\)" style="height: 0.6797em; vertical-align: -0.2062em; display: inline-block" class="org-latex org-latex-inline" />) are each a coefficient for a specific degrees, this is the idea of polynomial regression, we learn these coefficients to hopefully arrive at the desired function, or an approximation of it<br />
its still best to normalize the points to a discrete interval so that behavior is more predictable, e.g. by using linear interpolation to map the points to the interval <img src="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27%3F%3E%0A%3C%21-- This file was generated by dvisvgm 3.2.2 --%3E%0A%3Csvg version=%271.1%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27 width=%2729.68899pt%27 height=%2710.006208pt%27 viewBox=%27-.500002 -7.548551 29.68899 10.006208%27%3E%0A%3Cdefs%3E%0A%3Cpath id=%27g2-150%27 d=%27m1.942715-.059776c0-.826899-.577833-.956413-.806974-.956413c-.249066 0-.577833 .14944-.577833 .577833c0 .398506 .358655 .498132 .617684 .498132c.069738 0 .119552-.009963 .14944-.019925c.039851-.009963 .069738-.019925 .089664-.019925c.069738 0 .139477 .049813 .139477 .139477c0 .18929-.159402 .637609-.816936 1.05604l.089664 .18929c.298879-.099626 1.115816-.757161 1.115816-1.464508z%27/%3E%0A%3Cuse id=%27g4-49%27 xlink:href=%27%23g3-49%27 transform=%27scale%281.369862%29%27/%3E%0A%3Cpath id=%27g3-49%27 d=%27m2.865456 0v-.109091c-.574546-.007273-.690909-.08-.690909-.429091v-4.363638l-.058182-.014545l-1.309091 .661818v.101818c.087273-.036364 .167273-.065455 .196364-.08c.130909-.050909 .254546-.08 .327273-.08c.152727 0 .218182 .109091 .218182 .341818v3.294547c0 .24-.058182 .407273-.174546 .472727c-.109091 .065455-.210909 .087273-.516364 .094545v.109091h2.007274z%27/%3E%0A%3Cpath id=%27g1-0%27 d=%27m5.718555-2.281445v-.557908h-5.100872v.557908h5.100872z%27/%3E%0A%3Cpath id=%27g1-187%27 d=%27m2.978829 1.673724h-.856787c-.328767 0-.488169-.169365-.488169-.518057v-7.511831c0-.308842 .129514-.438356 .448319-.438356h.896638v-.249066h-2.102117v8.966376h2.102117v-.249066z%27/%3E%0A%3Cpath id=%27g1-188%27 d=%27m.33873 1.673724v.249066h2.102117v-8.966376h-2.102117v.249066h.856787c.328767 0 .488169 .169365 .488169 .518057v7.511831c0 .308842-.139477 .438356-.448319 .438356h-.896638z%27/%3E%0A%3C/defs%3E%0A%3Cg id=%27page5%27%3E%0A%3Cuse x=%27.597749%27 y=%270%27 xlink:href=%27%23g1-187%27/%3E%0A%3Cuse x=%274.214177%27 y=%270%27 xlink:href=%27%23g1-0%27/%3E%0A%3Cuse x=%2710.550413%27 y=%270%27 xlink:href=%27%23g4-49%27/%3E%0A%3Cuse x=%2715.531733%27 y=%270%27 xlink:href=%27%23g2-150%27/%3E%0A%3Cuse x=%2719.792367%27 y=%270%27 xlink:href=%27%23g4-49%27/%3E%0A%3Cuse x=%2724.773687%27 y=%270%27 xlink:href=%27%23g1-188%27/%3E%0A%3C/g%3E%0A%3C/svg%3E" alt="\([-1,1]\)" style="height: 0.9843em; vertical-align: -0.2418em; display: inline-block" class="org-latex org-latex-inline" />, after all, we can use the inverse linear map to remap the predicted values back to the original interval (i havent implemented this here, maybe later)<br />
this idea is implemented here:<br />
</p>
<div class="org-src-container" data-language="lisp">
<pre class="src src-lisp" id="src-polynomial-regression">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">polynomial-tensor-activation-function</span> (tensor indicies)
  <span style="font-style: italic;">"decides which degree to apply to a tensor cell based on its indicies"</span>
  (<span style="font-weight: bold;">let*</span> ((row-major (apply #'array-row-major-index (append (list tensor) indicies)))
         (myexponent (1+ row-major)) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">we dont want an exponent of 0</span>
         (value (aref-indicies tensor indicies)))
    (expt value myexponent)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">polynomial-tensor-activation-function-derivative</span> (tensor indicies)
  <span style="font-style: italic;">"the derivative for usage with polynomial-tensor-activation-function"</span>
  (<span style="font-weight: bold;">let*</span> ((row-major (apply #'array-row-major-index (append (list tensor) indicies)))
         (original-exponent (1+ row-major))
         (value (aref-indicies tensor indicies)))
    (* original-exponent (expt value (1- original-exponent)))))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">make-polynomial-regression-network</span> (<span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> (max-degree 3) (learning-rate 0.001))
  (make-network
   <span style="font-weight: bold;">:layers</span> (list (make-dense-layer
                  <span style="font-weight: bold;">:num-units</span> max-degree
                  <span style="font-weight: bold;">:prev-layer-num-units</span> 1
                  <span style="font-weight: bold;">:tensor-activation-function</span> #'polynomial-tensor-activation-function
                  <span style="font-weight: bold;">:tensor-activation-function-derivative</span> #'polynomial-tensor-activation-function-derivative)
                 (make-dense-layer
                  <span style="font-weight: bold;">:num-units</span> 1 <span style="font-weight: bold;">:prev-layer-num-units</span> max-degree
                  <span style="font-weight: bold;">:activation-function</span> #'identity
                  <span style="font-weight: bold;">:activation-function-derivative</span> (<span style="font-weight: bold;">lambda</span> (val) 1)))
   <span style="font-weight: bold;">:learning-rate</span> learning-rate))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">polynomial-regression-test</span> ()
  (<span style="font-weight: bold;">let</span> ((nw (make-polynomial-regression-network))
        (data (mapcar (<span style="font-weight: bold;">lambda</span> (mycons) (cons (make-array 1 <span style="font-weight: bold;">:initial-element</span> (car mycons))
                                             (make-array 1 <span style="font-weight: bold;">:initial-element</span> (cdr mycons))))
                      (generate-points-along-function
                       (<span style="font-weight: bold;">lambda</span> (x) (+ (expt x 2) 1))
                       2
                       1000
                       1)))
        (epochs 10000))
    (<span style="font-weight: bold;">loop</span> repeat epochs do
      (network-train nw data)
      (format t <span style="font-style: italic;">"loss ~A~%"</span> (network-test nw data)))))
</pre>
</div>
<p>
this works, its not that useful in this form but it can be used as a reference.</p>
</div>
</div>
</div>
</body>
</html>
